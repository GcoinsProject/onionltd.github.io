
<html lang="en">
<head>
    
    <title>Search results &ndash; Oniontree</title>
    <link rel="stylesheet" type="text/css" href="/style.css">

    <script
            src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>
    <script>
        function newResult(service){
            return $("<li></li>", { "class": "results_result" }).append(
                $("<a></a>", { "href": "/services/" + service + ".html" }).text(service)
            )
        }

        function newNoResult(){
            return $("<li></li>", { "class": "results_result" }).append(
                $("<p></p>").text("No results found for your query.")
            )
        }

        function newSearching(){
            return $("<li></li>", { "class": "results_result" }).append(
                $("<p></p>").text("Searching...")
            )
        }
    </script>
</head>
<body>
    
<div id="menu">
    <ul>
        <li id="logo"><a href="/">Oniontree</a></li>
        <li>&nbsp;</li>
        <li><a href="/services">Services</a></li>
        <li>|</li>
        <li><a href="/tags">Tags</a></li>
        <li>|</li>
        <li><a href="https://github.com/onionltd/oniontree">Download</a></li>
    </ul>

    <form action="/search.html">
        <input type="text" name="q" value="" placeholder="Search">
    </form>
</div>


    <div id="content">
        <h1>Search results for '<span id="name"></span>'</h1>

        <noscript>Sorry, search requires javascript.</noscript>

        <ul id="results"></ul>
    </div>

    <script>
        let query = new URLSearchParams(new URL(window.location.href).search).get("q");
        if ( query != null ) {
            $("#name").text(query);
            $("#results").empty();
            $("#results").append(newSearching());
            $.get("https://api.github.com/search/code", {"q": "repo:onionltd/oniontree path:unsorted/" + " " + query}, function(data){
                $("#results").empty();
                for ( let i = 0; i < data["total_count"]; i++ ) {
                    let id = data["items"][i]["name"].split('.').slice(0, -1).join('.');
                    $("#results").append(newResult(id));
                }

                if ( data["total_count"] == 0 ) {
                    $("#results").append(newNoResult());
                }
            });
        }
    </script>
</body>
</html>
